# Комментарии к решению 
## Экспорт модуля map
При первом запуске в консоли получаем
```
WARNING in ./src/index.js 4:2-9
"export 'default' (imported as 'initMap') was not found in './map'
```

Можно решить следующими способами:
В src/map.js, 5
```
export default function initMap(ymaps, containerId) {
```
или в src/index.js, 1, 
```
import { initMap } from "./map";
```
Так как в проекте используется вторая форма записи, выбираем ее

## Нулевая высота div
Открываем браузер, видим пустую страницу, ошибок в консоли нет.
Открываем консоль -> Elements, видим, что компонент карт был инициализирован и смонтирован в DOM. Контейнер, содержащий карты, имеет высоту 0.
![1](https://pp.userapi.com/c824203/v824203828/1927da/uCgQ8Pwi60M.jpg)

Меняем ее на полную высоту экрана:
```
#map {
  height: 100vh;
}
```

## Отображение станций
Карта отображается, но на ней нет станций. Сравниваем содержимое файла map.js с [документацией](https://tech.yandex.ru/maps/doc/jsapi/2.1/dg/concepts/object-manager/about-docpage/) и примером в [песочнице](https://tech.yandex.ru/maps/jsbox/2.1/object_manager), обнаруживаем, что, несмотря на то, что объекты были созданы, разработчик забыл добавить их на карту.
```
loadList().then(data => {
    console.log(data);
    objectManager.add(data);
  });
```
Исправляем: 
```
myMap.geoObjects.add(objectManager);
```

## Позиционирование станций
Но где же станции? При загрузке отображается карта Москвы, а станции находятся на территории Ирана? Звучит нелогично.
![2](https://pp.userapi.com/c824203/v824203828/192800/jpuvuLeLCLA.jpg)
Учитывая, что значения широты и долготы для центра карты и для генерации данных очень похожи, по всей видимости, они перепутаны. Меняем местами ключи: 
```
long: 55.755222 + rand() * 0.12242,
lat: 37.62102 + rand() * 0.180189
```
Предположение оказалось верным, теперь станции расположены в пределах Москвы и ближайшего Подмосковья

## Изменение иконки кластера, в котором есть неисправный объект
В процессе решения данной проблемы сначала удалось найти [комментарий пользователя Masis Abul к посту в блоге](https://yandex.ru/blog/mapsapi/55358)

Затем нашел идентичный пример в документации (**Опечатка в документации?** В примере в документации в объекте cluster используется свойство numbers, однако, скорее всего, имелось в виду number)
```
function onClusterCollectionAdd (e) {
   var cluster = e.get('child');
   // Для кластеров, в состав которых входит больше 10 меток,
   // зададим значок красного цвета.
   if (cluster.numbers > 10) {
       objectManager.clusters.setClusterOptions(cluster.id, {
           preset: 'islands#redClusterIcons'
       });
   }
}
// Подписываемся на событие добавления кластера в коллекцию.
objectManager.clusters.events.add(['add'], onClusterCollectionAdd);
```

В качестве условия проверяем массив входящих в него геообъектов на предмет вхождения хотя бы одного дефектного элемента при помощи функции Array.prototype.some().
```
if (cluster.properties.geoObjects.some(object => !object.isActive)) {
```

Получаем следующую картину:
![3](https://pp.userapi.com/c846019/v846019655/a61c7/Om_mnx-fsWM.jpg)

## Незакрытый div в шаблоне балуна
Переходим к отображению балуна.

При открытии файла, первым делом, проверил верстку в шаблоне, паучье чутье не подвело :)
details.js:
```
const BalloonContentLayout = ymaps.templateLayoutFactory.createClass(
    `<div class="details-info">
      </div>
    `,
```

## Модуль popup
Стоп, а зачем нам модуль popup.js? Модуль с функцией getPopupContent() нигде не испортируется, а его функционал похож на генерацию шаблона для details.js. Модуль обрабатывает данные, которых нет в текущей версии приложения.
```
 <td>${obj.operator}</td>
```

По всей видимости, данный модуль является устаревшим и в основной ветке подлежит удалению.

## Контекст стрелочной функции
При попытке открыть балун получаем длинное исключение в консоль.
![4](https://pp.userapi.com/c848624/v848624231/34252/w7JVN2QAlQQ.jpg)

Отсутствие модулей приложения в стэке вызовов сигнализирует о передаче неверного аргумента в предоставляемую функцию. Пробуем найти момент, когда кидается исключение. Ставим debugger в самое начало переопределения функции build в details.js, заходит. И далее не выполняется следующая строка
```
BalloonContentLayout.superclass.build.call(this);
``` 

В данном случае передается неверный контекст. Стрелочная функция сохраняет контекст модуля details.js со значением undefined, в то время как требуется содержать ссылку на объект, который будет вызывать данный метод из combine.js.
![5](https://pp.userapi.com/c848416/v848416100/36f46/Ys6YMTdtEMI.jpg)

Меняем в details.js стрелочные функции переопределения build и clear на function()
```
build: function() {
clear: function() {
```

Теперь балун отображается корректно, осталось поправить ошибки в графике
![6](https://pp.userapi.com/c845520/v845520975/a74d3/kTAkuVmweUI.jpg)

## Отображение графика
Ошибок в консоли нет, график не отображается. Скорее всего, ошибка логическая. Благодаря удачному наименованию параметров, ошибку можно заметить, даже не прибегая к документации. Значения по оси Y от нуля до нуля - явное противоречие
```
yAxes: [{ ticks: { beginAtZero: true, max: 0 } }]
```

Варианты решения [замечательно описаны](http://www.chartjs.org/docs/latest/axes/cartesian/linear.html#axis-range-settings). 
Наиболее оправданным решением считаю не устанавливать максимальное значение (или установить suggestedMax вместо max), а также явно указать stepSize для более удобного восприятия информации

## Опционально. Формат даты
Стилизационное украшение.
в chart.js
```
return x.toLocaleString();
```
![7](https://pp.userapi.com/c849528/v849528576/29d59/m4Lv4y0t-DQ.jpg)

## Опционально. Формат индекса
Стилизационное украшение. Задание формата индекса позволит работать с индексами, похожими на действущие по г. Москва
```
serialNumber: faker.address.zipCode("1#####"),
```
![8](https://pp.userapi.com/c849528/v849528576/29d68/rszZTVdN9aM.jpg)

---

# Задание 1 — найди ошибки

В этом репозитории находятся материалы тестового задания "Найди ошибки" для [14-й Школы разработки интерфейсов](https://academy.yandex.ru/events/frontend/shri_msk-2018-2) (осень 2018, Москва, Санкт-Петербург, Симферополь).

Для работы тестового приложения нужен Node.JS v9. В проекте используются [Yandex Maps API](https://tech.yandex.ru/maps/doc/jsapi/2.1/quick-start/index-docpage/) и [ChartJS](http://www.chartjs.org).

## Задание

Код содержит ошибки разной степени критичности. Некоторые из них — стилистические, а другие — даже не позволят вам запустить приложение. Вам нужно найти все ошибки и исправить их.

Пункты для самопроверки:

1. Приложение должно успешно запускаться.
1. По адресу http://localhost:9000 должна открываться карта с метками.
1. Должна правильно работать вся функциональность, перечисленная в условиях задания.
1. Не должно быть лишнего кода.
1. Все должно быть в едином codestyle.

## Запуск

```
npm i
npm start
```

При каждом запуске тестовые данные генерируются заново случайным образом.


